<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8"/>
    <title>Grade Report Application</title>

    <!--    <link href="/webjars/bootstrap/css/bootstrap.min.css"-->
    <!--          th:href="@{/webjars/bootstrap/css/bootstrap.min.css}"-->
    <!--          rel="stylesheet" media="screen"/>-->
    <!--    <script src="/webjars/jquery/jquery.min.js"-->
    <!--            th:src="@{/webjars/jquery/jquery.min.js}"></script>-->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    .body {
      min-height: 75rem;
      padding-top: 4.5rem;
    }


    </style>

    <link type="text/css" rel="stylesheet" href="${ctx}/components/fileinput/css/fileinput.css"/>
    <script>
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", "http://3.87.245.100:20488/all", false ); // false for synchronous request
            xmlHttp.send( null );
            window.localStorage.setItem("grade_report", xmlHttp.responseText);
            console.log("fetching data");
    </script>

</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="#">Grade Report 自助成绩分析工具</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item ">
                <a class="nav-link" href="/">File Upload</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="/history">Analysis History<span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="/about" > About</a>
            </li>
        </ul>

    </div>
</nav>
<div>
<main role="main" class="container" id= "myTable">

    <div>
        </br>
        </br>
        </br>

    </table>
    </div>
    <script>

            file = JSON.parse(window.localStorage.getItem("grade_report"));
            var mytable = "<table class='table table-hover'> <thead class= 'thead-dark'><tr><th scope='col'>#</th><th scope='col'>Grade Report Result List</th></tr></thead><tbody><tr>";
            for (var i = 1; i <= file.length; i++) {
                    mytable += "<tr>";
                    mytable += '<th scope="row">' + i + "</th>";
                mytable += "<td onclick = window.open('"+ file[i-1].fileURL + "') >" + file[i-1].fileName+ "</td>";

                mytable += "</tr>";
            }

            mytable += "</tr></tbody></table>";

            document.write(mytable);

    </script>
</main>
</div>

<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>

</body>
</html>